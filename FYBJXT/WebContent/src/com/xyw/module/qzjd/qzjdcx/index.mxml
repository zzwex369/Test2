<?xml version="1.0" encoding="utf-8"?>
<s:Module xmlns:fx="http://ns.adobe.com/mxml/2009" 
		  xmlns:s="library://ns.adobe.com/flex/spark" 
		  xmlns:mx="library://ns.adobe.com/flex/mx" width="100%" height="100%"
		  xmlns:component="com.xyw.sys.custom.component.*"
		  creationComplete="moduleCompleteHandler(event)">
	<fx:Declarations>
		<s:RemoteObject id="D607Service" destination="D607Service"
						endpoint="{this.parentApplication.contextRoot}/messagebroker/amf"
						showBusyCursor="true">
			<s:method name="queryD607" result="queryD607Handler(event)" />
			<s:method name="deleteD607" result="deleteD607Handler(event)" />
		</s:RemoteObject>
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[     
			import com.xyw.module.qzjd.model.D607;
			import com.xyw.module.qzjd.model.D607Request;
			import com.xyw.module.qzjd.model.VD607;
			import com.xyw.sys.model.ComboBoxData;
			import com.xyw.sys.model.ComboBoxDataRequest;
			import com.xyw.sys.model.ComboBoxDataResponse;
			import com.xyw.sys.model.SystemUser;
			
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.events.ResultEvent;
			
			import spark.events.GridSelectionEvent;
				 
			public var systemUser:SystemUser = null;
			public var d607request:D607Request;
			public var vD607:VD607=null;
			public var d607:D607=null;
			
			private function moduleCompleteHandler(event:FlexEvent):void
			{
				//this.timeStart.text=DateField.dateToString(new Date(),"YYYY-MM-01");
				//this.timeEnd.text=DateField.dateToString(new Date(),"YYYY-MM-DD");
				this.D607Data.addEventListener(GridSelectionEvent.SELECTION_CHANGE,onSelected);
			}
			private function onSelected(event:GridSelectionEvent):void
			{
				this.vD607= DataGrid(event.target).selectedItem as VD607;
			}
			/*----------获取查询条件数据---------*/
			private function initQueryParam():void
			{
				d607=new D607();
						d607.d60702=this.D607_02.text;
						d607.d60704=this.D607_04.text;
						d607.d60714=this.D607_14.text;
						d607.d60720=this.d607_20.text;	
			
			}  
			public function refresh():void
			{
				d607request= new D607Request();
				this.initQueryParam();  
				d607request.d607=d607;
				d607request.parameterPageindex = 1;
				d607request.parameterPagesize = 20;
				
				this.D607Service.queryD607(d607request);
			}
			public function queryd607(event:MouseEvent):void{
				  
				d607request= new D607Request();
				this.initQueryParam();  
				d607request.d607=d607;
				d607request.parameterPageindex = 1;
				d607request.parameterPagesize = 20;
			
				this.D607Service.queryD607(d607request);
			}
			public function queryD607Handler(event:ResultEvent):void{
				var d607Response:Object = event.result;
				var rowCount:Number = d607Response.rowCount;
			
				if(d607Response.errorMessage == null)
				{
					if(d607Response.promptMessage!=null){
						Alert.show(d607Response.promptMessage,"系统提示");
					}
					var listVD607:ArrayCollection = d607Response.vd607s;
					this.pagerBar.dataGrid = this.D607Data;
					this.pagerBar.rowCount = rowCount;
					this.pagerBar.resultData = listVD607;
					this.pagerBar.dataBind();
					this.pagerBar.pagerFunction = pagerFunction;
					if(rowCount > 0) {
						this.pagerBar.enabled = true;
					}
				} else {   
					Alert.show(d607Response.errorMessage, "系统提示");
				}
			}
			public function pagerFunction(currentPageIndex:int, pageSize:int):void
			{
				d607request= new D607Request();
				this.initQueryParam();
				d607request.d607=d607;
				d607request.parameterPageindex = 1;
				d607request.parameterPagesize = 20;
				this.D607Service.queryD607(d607request);
			}
			public function updated607(event:MouseEvent):void{
				if(this.vD607 == null){  
					Alert.show("请选择要操作的行");
					return;  
				}
					var window:updatewindow = new updatewindow();
					window.owner = this;
					window.vd607 = this.vD607;
					PopUpManager.addPopUp(window,this);
					var x:Number = (this.parentApplication.mdiCanvas.width - window.width)/2;
					var y:Number = (this.parentApplication.mdiCanvas.height - window.height)/2;
					window.move(x,y);
			}
			
			public function deleted607(event:MouseEvent):void
			{
				if(this.vD607 == null){  
					Alert.show("请选择要操作的行");
					return;  
				}
				d607=new D607();
				d607request = new D607Request();
				var d60701:Number=this.vD607.d60701;
				d607.d60701=d60701;
				d607request.d607=d607;
				this.D607Service.deleteD607(d607request);
			}
			public function deleteD607Handler(event:ResultEvent):void
			{
				var d607Response:Object = event.result;
				if(d607Response.errorMessage == null){
					if(d607Response.promptMessage != null){
						Alert.show(d607Response.promptMessage, "系统提示");
					}
					refresh();
				} else {
					Alert.show(d607Response.errorMessage, "系统提示");
				}
			}
		]]>
	</fx:Script>
	<s:VGroup width="100%">
		<mx:TabNavigator id="xuanze"  width="100%" chromeColor="#ffffff" creationPolicy="all">
			<s:NavigatorContent label="查询" width="100%">
				<s:VGroup>
					<s:HGroup width="100%" paddingBottom="0" paddingLeft="10" paddingRight="10" verticalAlign="middle">
						<s:Label text="父亲姓名"/><s:TextInput id="D607_02"/>
						<s:Label text="父亲身份证号"/><s:TextInput id="D607_04" width="140"/>
					</s:HGroup>
					<s:HGroup width="100%" paddingBottom="0" paddingLeft="10" paddingRight="10" verticalAlign="middle">
						<s:Label text="子女姓名"/><s:TextInput id="D607_14"/>
						<s:Label text="亲子鉴定号"/><s:TextInput id="d607_20" width="140"/>
					</s:HGroup>
					<s:HGroup width="100%" paddingBottom="10" paddingLeft="10" paddingRight="10" verticalAlign="middle">
						<s:Button label="查询"  click="queryd607(event)"/>
						<s:Button label="修改"  click="updated607(event)"/>
						<s:Button label="删除" click="deleted607(event)"/>
					</s:HGroup>
				</s:VGroup>
			</s:NavigatorContent>
		</mx:TabNavigator>
		<s:DataGrid id="D607Data" editable="true" rowHeight="22" width="100%" height="330" alternatingRowColors="[#FFFFFF,#EEEEEE]" skinClass="com.xyw.sys.custom.skin.CustomDataGridSkin">
			<s:columns>
				<s:ArrayList>
					<s:GridColumn dataField="d60701" headerText="主键" visible="false"/>
					<s:GridColumn headerText="序号" width="70" itemRenderer="com.xyw.sys.custom.itemrenderer.CustomGridColumnItemRenderer" editable="false"/>
					<s:GridColumn dataField="d60702" headerText="父亲姓名" width="80"/>
					<s:GridColumn dataField="d60704" headerText="父亲身份证号" width="140"/>
					<s:GridColumn dataField="d60708" headerText="母亲姓名" width="90"/>
					<s:GridColumn dataField="d60710" headerText="母亲身份证号" width="140"/>
					<s:GridColumn dataField="d60714" headerText="子女姓名" width="90"/>
					<s:GridColumn dataField="d60716" headerText="子女身份证号" width="140"/>
					<s:GridColumn dataField="d60715_str" headerText="子女出生日期" width="110"/>
					<s:GridColumn dataField="d60721" headerText="鉴定人" width="90"/>
					<s:GridColumn dataField="d60723_str" headerText="鉴定日期" width="90" />
					<s:GridColumn dataField="d60729ZH" headerText="是否为亲子关系 " width="90"/>
					<s:GridColumn dataField="d60725" headerText="案情摘要"/>
				</s:ArrayList>
			</s:columns>    
		</s:DataGrid>
		<component:PagerBar id="pagerBar" enabled="false"/>
	</s:VGroup>
</s:Module>
