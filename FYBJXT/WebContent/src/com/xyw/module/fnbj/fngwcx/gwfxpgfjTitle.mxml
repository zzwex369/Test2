<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   backgroundColor="white" chromeColor="#5CACEE"
			   close="removeWindow()" cornerRadius="5" creationComplete="putRecord()"
			   skinClass="com.xyw.sys.custom.skin.CustomTitleWindow" title="孕产妇妊娠风险评估分级报告单">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Style>
		@namespace s "library://ns.adobe.com/flex/spark";
		@namespace mx "library://ns.adobe.com/flex/mx";
		@namespace skin "com.xyw.sys.custom.skin.*";
		.textInput{
			skinClass:ClassReference("com.xyw.sys.custom.skin.CustomTextInputSkin");
		}
		.myLabel {
			fontSize:12px;
			paddingTop:2px;
		}
	</fx:Style>
	<fx:Script>
		<![CDATA[
			import mx.controls.DateField;
			import mx.managers.PopUpManager;
			import mx.printing.FlexPrintJob;
			import mx.printing.FlexPrintJobScaleType;
			[Bindable]
			public var vf308:Object;
			[Bindable]
			private var now:Date=new Date();
			private function removeWindow():void
			{
				PopUpManager.removePopUp(this);
			}
			private function putRecord():void
			{
				F308_03.text=vf308.f30803;
				F308_05.text=vf308.f30805;
				F308_08.text=vf308.f30808;
				F308_10.text=vf308.f30810;
				F308_15.text=vf308.f30815;
				F308_16.text=vf308.f30816Zh;
				F308_07.text=DateField.dateToString(vf308.f30807,'YYYY-MM-DD');
				age.text=getAge(); 
			}
			
			private function getAge():String{
				var year:Number = Number(F308_07.text.substr(0,4));
				var month:Number = Number(F308_07.text.substr(5,2));
				var day:Number = Number(F308_07.text.substr(8,2));
				var date:Date = new Date();
				var nowDay:Number = date.date;
				var nowMonth:Number = date.month + 1;
				var nowYear:Number = date.fullYear;
				var age:Number;
				if(nowMonth < month){
					age = nowYear - year - 1;
				}else if(nowMonth == month){
					if(day > nowDay){
						age = nowYear - year -1;
					}else{
						age = nowYear - year;
					}
				}else if(nowMonth > month){
					age = nowYear - year;
				}
				return age.toString();
			}
			
			private function printF308():void
			{
				var flexPrintJob:FlexPrintJob = new FlexPrintJob();
				flexPrintJob.printAsBitmap = false;
				if(flexPrintJob.start())
				{
					/* data.width=flexPrintJob.pageWidth;568
					data.height=flexPrintJob.pageHeight;815
					trace(data.width+"*****"+data.height); */
					flexPrintJob.addObject(data,FlexPrintJobScaleType.NONE);
					flexPrintJob.send(); 
				}
				
				
			}
			
		]]>
	</fx:Script>
	<s:VGroup  paddingBottom="10">
			<s:VGroup  id="data" width="568"  horizontalAlign="center"  gap="10" paddingBottom="10" >
				<s:HGroup width="100%">
					<s:Label width="100%" fontSize="20" paddingTop="35" paddingBottom="5"
							 text="孕产妇妊娠风险评估分级报告单"
							 textAlign="center"/>
				</s:HGroup>
				<mx:Grid horizontalGap="1" verticalGap="10">
					<mx:GridRow>
						<mx:GridItem>
							<s:Label width="100%" paddingLeft="5" text="姓       名：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="F308_03" width="100%" styleName="myLabel"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label width="100%" text="出生日期：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="F308_07"  width="100%" styleName="myLabel"/>
						</mx:GridItem>	
						<mx:GridItem>
							<s:Label width="100%" text="年       龄：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="age" styleName="myLabel"/>
							<s:Label text="（周岁）"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem>
							<s:Label width="100%" paddingLeft="5" text="孕       周：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="F308_08"  styleName="myLabel"/>
							<s:Label text="（周）"/>
						</mx:GridItem>	
						<mx:GridItem>
							<s:Label width="100%" text="联系电话：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="F308_10" styleName="myLabel"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label width="100%" text="证件号码：" textAlign="center"/>
						</mx:GridItem>
						<mx:GridItem>
							<s:Label id="F308_05" styleName="myLabel"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6">
							<s:Label paddingLeft="8" text="初步诊断：" textAlign="center"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6" paddingLeft="8">
							<s:TextInput width="100%" styleName="textInput"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6" paddingLeft="8">
							<s:TextInput width="100%" styleName="textInput"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6" paddingLeft="8">
							<s:TextInput width="100%" styleName="textInput"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem >
							<s:Label width="100%" textAlign="center" text="评估时间：" paddingLeft="5"/>
						</mx:GridItem>
						<mx:GridItem colSpan="6">
							<s:TextInput width="50"  text="{now.fullYear}" styleName="textInput"/>
							<s:Label   text="年"/>
							<s:TextInput width="50"  text="{now.month+1}" styleName="textInput"/>
							<s:Label    text="月"/>
							<s:TextInput width="50"  text="{now.date}" styleName="textInput"/>
							<s:Label   text="日"/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6">
							<s:Label  paddingLeft="8" text="评估分级："/>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="6">
							<s:HGroup  chromeColor="#FFFFFF" gap="75" horizontalAlign="center" verticalAlign="middle" paddingLeft="10">
								<s:CheckBox label="橙色" mouseEnabled="false"/>
								<s:CheckBox label="红色" mouseEnabled="false"/>
							</s:HGroup>
						</mx:GridItem>
					</mx:GridRow>
					<mx:GridRow>
						<mx:GridItem colSpan="4">
							<s:Label text="报  告 人：" width="100%" textAlign="right"/>
						</mx:GridItem>
						<mx:GridItem colSpan="2">
							<s:TextInput width="100%" id="F308_15" styleName="textInput"/>
						</mx:GridItem>
					</mx:GridRow>	
					<mx:GridRow>
						<mx:GridItem colSpan="4">
							<s:Label text="报告机构："  width="100%" textAlign="right"/>
						</mx:GridItem>
						<mx:GridItem colSpan="2">
							<s:TextInput width="100%" id="F308_16" styleName="textInput"/>
						</mx:GridItem>
					</mx:GridRow>	
					<mx:GridRow>
						<mx:GridItem colSpan="4">
							<s:Label text="报告日期：" width="100%" textAlign="right"/>
						</mx:GridItem>
						<mx:GridItem colSpan="2">
							<s:TextInput width="100%" styleName="textInput" text="{DateField.dateToString(now,'YYYY-MM-DD')}"/>
						</mx:GridItem>
					</mx:GridRow>	
				</mx:Grid>
			</s:VGroup>
				<s:HGroup id="print" width="100%" buttonMode="true" horizontalAlign="right" paddingRight="20">
					<s:Button label="打印" chromeColor="0XFFFFFF" click="printF308()" cornerRadius="5"/>
				</s:HGroup>
		</s:VGroup>
</s:TitleWindow>
