<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:hi="http://hi.csdn.net/To9m"
			   xmlns:component="com.xyw.sys.custom.component.*"
			   width="551" height="600" backgroundColor="white" chromeColor="#5CACEE"
			   close="removeWindow()" cornerRadius="5" creationComplete="putRecord()"
			   skinClass="com.xyw.sys.custom.skin.CustomTitleWindow"
			   title="孕产妇转诊单">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Style>
		@namespace s "library://ns.adobe.com/flex/spark";
		@namespace mx "library://ns.adobe.com/flex/mx";
		@namespace skin "com.xyw.sys.custom.skin.*";
		.textInput{
			skinClass:ClassReference("com.xyw.sys.custom.skin.CustomTextInputSkin");
		}
	</fx:Style>
	<fx:Script>
		<![CDATA[
			import mx.controls.DateField;
			import mx.core.UIComponent;
			import mx.managers.PopUpManager;
			import mx.printing.FlexPrintJob;
			import mx.printing.FlexPrintJobScaleType;
			[Bindable]
			public var vf308:Object;
			[Bindable]
			private var now:Date=new Date();
			private function removeWindow():void
			{
				PopUpManager.removePopUp(this);
			}
			private function putRecord():void
			{	
				F308_05.text=vf308.f30805;
				F308_10.text=vf308.f30810;
				F308_15.text=vf308.f30815;
				F308_16.text=vf308.f30816Zh;
				F308_03.text=F308_03_01.text=vf308.f30803;
				F308_08.text=F308_08_01.text=vf308.f30808;
				F308_07.text=F308_07_01.text=DateField.dateToString(vf308.f30807,'YYYY-MM-DD');
				age.text=_age.text=getAge(); 
			}
			
			private function getAge():String{
						var year:Number = Number(F308_07.text.substr(0,4));
						var month:Number = Number(F308_07.text.substr(5,2));
						var day:Number = Number(F308_07.text.substr(8,2));
						var date:Date = new Date();
						var nowDay:Number = date.date;
						var nowMonth:Number = date.month + 1;
						var nowYear:Number = date.fullYear;
						var age:Number;
						if(nowMonth < month){
							age = nowYear - year - 1;
						}else if(nowMonth == month){
							if(day > nowDay){
								age = nowYear - year -1;
							}else{
								age = nowYear - year;
							}
						}else if(nowMonth > month){
							age = nowYear - year;
						}
						return age.toString();
				}
			
			private function printF308():void
			{
				var flexPrintJob:FlexPrintJob = new FlexPrintJob();
				flexPrintJob.printAsBitmap = false;
				if(flexPrintJob.start())
				{
					flexPrintJob.addObject(this.data,FlexPrintJobScaleType.MATCH_WIDTH);
					flexPrintJob.send();
				}
				
			}
			 
		]]>
	</fx:Script>

	<s:VGroup verticalCenter="0" horizontalCenter="0" width="100%">
	<s:VGroup verticalAlign="middle" horizontalAlign="center" gap="10"  paddingBottom="10" id="data" width="100%" >
		<s:HGroup width="100%">
			<s:Label width="100%"  textAlign="center" text="妊娠风险筛查阳性孕产妇转诊单" fontSize="20" paddingTop="5" paddingBottom="5"/>
		</s:HGroup>
		<mx:Grid verticalGap="10" horizontalGap="1" verticalAlign="middle" horizontalAlign="center">
			<mx:GridRow>
				<mx:GridItem>
					<s:Label  text="姓       名：" paddingLeft="5" width="100%"  textAlign="center"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="F308_03"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label width="100%"  textAlign="center" text="出生日期："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="F308_07"/>
				</mx:GridItem>	
				<mx:GridItem >
					<s:Label width="100%"  textAlign="center" text="年       龄："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="age" />
					<s:Label   text="（周岁）"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem >
					<s:Label width="100%" textAlign="center" text="孕       周：" paddingLeft="5"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="F308_08"/>
					<s:Label   text="（周）"/>
				</mx:GridItem>	
				<mx:GridItem>
					<s:Label width="100%"  textAlign="center" text="联系电话："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="F308_10"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label width="100%" textAlign="center" text="证件号码："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label   id="F308_05"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6">
					<s:Label  textAlign="center" text="筛查结果（主要危险因素）："  paddingLeft="8"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6"  paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput" />
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6" paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6" paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem >
					<s:Label width="100%" textAlign="center" text="转诊日期：" paddingLeft="5"/>
				</mx:GridItem>
				<mx:GridItem colSpan="3">
					<s:TextInput width="50"  text="{now.fullYear}" styleName="textInput"/>
					<s:Label   text="年"/>
					<s:TextInput width="50"  text="{now.month+1}" styleName="textInput"/>
					<s:Label    text="月"/>
					<s:TextInput width="50"  text="{now.date}" styleName="textInput"/>
					<s:Label   text="日"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label width="100%" textAlign="center"   text="医生签名："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:TextInput width="100%" id="F308_15"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem >
					<s:Label width="100%"  textAlign="center" text="转出机构：" paddingLeft="5"/>
				</mx:GridItem>
				<mx:GridItem colSpan="5">
					<s:TextInput width="50%" id="F308_16"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow horizontalAlign="center" verticalAlign="middle" paddingTop="20">
				<mx:GridItem colSpan="6">
					<s:Label width="100%" text="注意！以下由接诊机构填写" fontSize="17" color="red" textAlign="center"  verticalAlign="middle"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow paddingTop="20">
					<mx:GridItem >
						<s:Label width="100%" textAlign="center"  text="姓       名：" paddingLeft="5"/>
					</mx:GridItem>
					<mx:GridItem>
						<s:Label   id="F308_03_01"/>
					</mx:GridItem>
					<mx:GridItem>
						<s:Label width="100%" textAlign="center"   text="出生日期："/>
					</mx:GridItem>
					<mx:GridItem>
						<s:Label   id="F308_07_01"/>
					</mx:GridItem>	
					<mx:GridItem>
						<s:Label width="100%" textAlign="center"  text="年       龄："/>
					</mx:GridItem>
					<mx:GridItem>
						<s:Label   id="_age"/>
						<s:Label   text="（周岁）"/>
					</mx:GridItem>
				</mx:GridRow>
				<mx:GridRow>
					<mx:GridItem >
						<s:Label  width="100%" textAlign="center" text="孕       周：" paddingLeft="5"/>
					</mx:GridItem>
					<mx:GridItem>
						<s:Label   id="F308_08_01"/>
						<s:Label   text="（周）"/>
					</mx:GridItem>	
					<mx:GridItem>
						<s:Label width="100%" textAlign="center"   text="接诊日期："/>
					</mx:GridItem>
					<mx:GridItem colSpan="3">
						<s:TextInput width="50"  styleName="textInput"/>
						<s:Label   text="年"/>
						<s:TextInput width="50"  styleName="textInput"/>
						<s:Label   text="月"/>
						<s:TextInput width="50"  styleName="textInput"/>
						<s:Label   text="日"/>
					</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6">
					<s:Label   text="目前诊断：" paddingLeft="8"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6" paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6" paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6" paddingLeft="8">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6">
					<s:Label  paddingLeft="8" text="妊娠风险评估分级（请在相关项目上打勾）："/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem colSpan="6">
					<s:HGroup  chromeColor="#FFFFFF" gap="75" horizontalAlign="center" verticalAlign="middle" paddingLeft="8">
						<s:CheckBox label="绿色"/>
						<s:CheckBox label="黄色"/>
						<s:CheckBox label="橙色"/>
						<s:CheckBox label="红色"/>
						<s:CheckBox label="紫色"/>
					</s:HGroup>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow>
				<mx:GridItem >
					<s:Label  width="100%" textAlign="center" text="接诊机构：" paddingLeft="5"/>
				</mx:GridItem>
				<mx:GridItem colSpan="3">
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
				<mx:GridItem>
					<s:Label width="100%" textAlign="center" text="医生签名："/>
				</mx:GridItem>
				<mx:GridItem>
					<s:TextInput width="100%"  styleName="textInput"/>
				</mx:GridItem>
			</mx:GridRow>
		</mx:Grid>
	</s:VGroup>
		<s:HGroup id="print" horizontalAlign="right" width="100%" paddingRight="10" buttonMode="true">
			<s:Button click="printF308()" label="打印" cornerRadius="5" chromeColor="0XFFFFFF"/>
		</s:HGroup>
	</s:VGroup>
</s:TitleWindow>
